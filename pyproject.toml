[build-system]
requires = [
    "setuptools>=75.3",
    "wheel",
    "setuptools-scm>=8",
    "numpy>=1.21",
    "numba>=0.57, <0.58",
    "cmake>=3.20",
]
build-backend = "setuptools.build_meta"

[project]
name = "pyomp"
dynamic = ["version"]
description = "Python OpenMP library based on Numba"
readme = "README.md"
requires-python = ">=3.8, <3.12"
license = { text = "BSD-2-Clause" }
classifiers = [
    "Programming Language :: Python :: 3",
    "Operating System :: OS Independent",
    "Development Status :: 4 - Beta",
    "Intended Audience :: Developers",
    "Topic :: Software Development :: Compilers",
]
dependencies = ["numba>=0.57, <0.58", "lark", "cffi"]

[project.urls]
Homepage = "https://github.com/Python-for-HPC/PyOMP"
Issues = "https://github.com/Python-for-HPC/PyOMP/issues"

[tool.setuptools]
include-package-data = true

# Use discovery for the numba.* namespace.
[tool.setuptools.packages.find]
include = ["numba*", "numba.openmp*", "numba.openmp.libs*"]
exclude = ["numba.openmp.tests*"]

# Bundle the CMake-installed artifacts into the wheel.
[tool.setuptools.package-data]
"numba.openmp.libs" = [
    "pass/*",
    "pass/**/*",
    "libomp/*",
    "libomp/**/*",
    "nrt/*",
]

# setuptools-scm config
[tool.setuptools_scm]
# put version into your runtime package (non-src layout)
write_to = "numba/openmp/_version.py"
